<!doctype html>
<html>
<head>
  <meta charset="utf-8">
  <title>Dust to Dust</title>
</head>
  <script src="pixi.min.js"></script>
<body>
  <script type="text/javascript">
    let stage = new Container(),
        renderer = autoDetectRenderer(512, 512);
    document.body.appendChild(renderer.view);

    renderer.view.style.border = "1px dashed black";
    renderer.backgroundColor = "0xFFFFFF";

    loader
      .add("Odyssey.jpg")
      .load(setup);

    let sprite, state;
    
    function setup() {
      sprite = new Sprite(resources["Odyssey.jpg"].texture);
      
      sprite.x = renderer.view.width / 2 - pixie.width / 2
      sprite.y = renderer.view.width / 2 - pixie.height / 2
      sprite.vx = 0
      sprite.vy = 0
      
      stage.addChild(sprite);
      
      var left = keyboard(37), up = keyboard(38), right = keyboard(39), down = keyboard(40);

      left.press = () => {sprite.vx = -5; sprite.vy = 0;};
      left.release = () => {if (!right.isDown && cat.vy === 0) {sprite.vx = 0;}};

      up.press = () => {sprite.vy = -5; sprite.vx = 0;};
      up.release = () => {if (!down.isDown && cat.vx === 0) {sprite.vy = 0;}};

      right.press = () => {sprite.vx = 5; sprite.vy = 0;};
      right.release = () => {if (!left.isDown && cat.vy === 0) {sprite.vx = 0;}};

      down.press = () => {sprite.vy = 5;sprite.vx = 0;};
      down.release = () => {if (!up.isDown && cat.vx === 0) {sprite.vy = 0;}};
      
      state = play;
      
      gameLoop();
    }
    
    function gameLoop() {
      requestAnimationFrame(gameLoop);
      
      state();
      
      renderer.render(stage);
    }
    
    function play() {
      sprite.y += sprite.vy
      sprite.x += sprite.vx
    }
  </script>
</body>
</html>
